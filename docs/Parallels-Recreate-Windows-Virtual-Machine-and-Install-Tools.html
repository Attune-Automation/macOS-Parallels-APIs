
<!doctype html>
<html lang="en">




<head>
    <title>How to Parallels Recreate Windows Virtual Machine and Install Tools - Attune Automation</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="title"
          content="How to Parallels Recreate Windows Virtual Machine and Install Tools - Attune Automation">
    <meta name="description"
          content="">
    <meta name="robots"
          content="follow, index, max-snippet:-1, max-video-preview:-1, max-image-preview:large">

    <meta property="og:locale" content="en_AU" />
    <meta property="og:type" content="article" />
    <meta property="og:title"
          content="HowTo Parallels Recreate Windows Virtual Machine and Install Tools - Attune Automation" />
    <meta property="og:description" content="" />
    <meta property="og:site_name" content="Attune Automation" />
    <meta property="article:section" content="IT Instruction" />

    <meta name="twitter:title"
          content="How to Parallels Recreate Windows Virtual Machine and Install Tools - Attune Automation" />
    <meta name="twitter:description" content="" />

    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-32x32.png" sizes="32x32">
    <link rel="icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-192x192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-180x180.png">
    <meta name="msapplication-TileImage" content="https://www.servertribe.com/wp-content/uploads/2020/10/cropped-server_tribe_favicon-270x270.png">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
          crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="styles/style.css">

    <!-- Google tag (gtag.js) -->
    <script async
            src="https://www.googletagmanager.com/gtag/js?id=G-5TZQZNDJCD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-5TZQZNDJCD');
    </script>
</head>


<body>

<!-- Project NavBar -->

<div class="bg-white border-bottom box-shadow sticky-top mb-3">
<div class="container px-0">
    <div class="row px-0">
        <div class="col d-flex flex-column flex-lg-row align-items-center px-0
            py-3">
            <a class="navbar-brand my-0 mr-lg-auto"
                  href="https://www.servertribe.com/"
                  target="_blank">
                    <img
                        src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                        alt="Attune - Powered by ServerTribe"
                        class="img-fluid navbar-img">
            </a>
            <nav class="my-2 my-lg-0 mr-lg-3">
                <a class="p-2 text-dark" href="http://doc.servertribe.com/"
                   target="_blank">
                    Documentation
                </a>
                <a class="p-2 text-dark"
                   href="https://discord.com/invite/3YpJsagqUn"
                   target="_blank">
                    Discord
                </a>
                <a class="p-2 text-dark" href="https://github.com/Attune-Automation"
                   target="_blank">
                    GitHub
                </a>
                <a class="p-2 text-dark" href="https://www.servertribe.com/learn/"
                   target="_blank">
                    Learn
                </a>
            </nav>
            <a class="btn btn-outline-primary"
               href="https://www.servertribe.com/download-attune-registration/"
               target="_blank">
                Download NOW!
            </a>
        </div>
    </div>
</div></div>

<!-- Project breadcrumbs -->

<!-- Project breadcrumbs -->
<div class="container px-0">
    <div class="row">
        <nav class="col px-0" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="index.html">
                    macOS Parallels APIs
                    </a>
                </li>
                <li class="breadcrumb-item active" aria-current="page">
                    <strong>Parallels Recreate Windows Virtual Machine and Install Tools</strong>
                </li>
            </ol>
        </nav>
    </div>
</div>

<!-- Blueprint Header -->

<div class="container px-0">
    <!-- Blueprint name and description -->
    <div class="row">
        <div class="col px-0">
            <h1 class="text-left">
                How to Parallels Recreate Windows Virtual Machine and Install Tools
            </h1>
        </div>
    </div>

<!-- Blueprint Description -->
    <div class="row pt-4">
        <div class="col-6 px-0">
            <h6 class="text-left">
                This documentation is generated by
                <a href="https://www.servertribe.com/"
                    class="badge badge-primary"
                    target="_blank">
                    Attune
                </a>
            </h6>
        </div>
        <div class="col-6 align-self-end text-right px-0">
            <h6 class="text-right">
                <a href="https://www.youtube.com/@servertribe"
                    class="badge badge-secondary"
                    target="_blank">
                    YouTube
                </a>
                <a href="https://github.com/Attune-Automation"
                    class="badge badge-secondary"
                    target="_blank">
                    GitHub
                </a>
                <a href="https://discord.com/invite/3YpJsagqUn"
                    class="badge badge-secondary"
                    target="_blank">
                    Discord
                </a>
                <a href="https://www.linkedin.com/company/servertribe/"
                    class="badge badge-secondary"
                    target="_blank">
                    LinkedIn
                </a>
                <a href="http://doc.servertribe.com/"
                    class="badge badge-secondary"
                    target="_blank">
                    Documentation
                </a>
            </h6>
        </div>
    </div>
    <hr>
</div>

<div class="documentation">
    <div class="container px-0">
        <div class="row">

<!-- Blueprint ToC -->


            <div class="toc col-lg-2 px-0 pr-5">
                <div class="container px-0 pt-3">
                    <p class="pb-2">
                        <strong>Contents</strong>
                    </p>
                    <p class="text-muted">
                        <a href="#top">
                            <strong>Parallels Recreate Windows Virtual Machine and Install Tools</strong>
                        </a>
                    </p>


    
        

                    <p class="text-muted pt-2">
                        <a href="#recreatewindowsvirtualmachineonmacosparallels">
                            <strong>Step 1 -</strong> Recreate Windows Virtual Machine on macOS Parallels
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#deletevm">
                            <strong>Step 1.1 -</strong> Delete VM
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#createvm">
                            <strong>Step 1.2 -</strong> Create VM
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#loadwindowsiso">
                            <strong>Step 1.3 -</strong> Load Windows ISO
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#startvm">
                            <strong>Step 1.4 -</strong> Start VM
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#winrmhttpswait120sdelay">
                            <strong>Step 1.5 -</strong> WinRM HTTPS Wait 120s Delay
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#removecdromdrivesandrestart">
                            <strong>Step 2 -</strong> Remove CD ROM Drives and Restart
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#winrmhttpswait120sdelay">
                            <strong>Step 2.1 -</strong> WinRM HTTPS Wait 120s Delay
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#kswpshutdownvm">
                            <strong>Step 2.2 -</strong> KSWP Shutdown VM
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#kswpremovewindowsanddriverscdroms">
                            <strong>Step 2.3 -</strong> KSWP Remove Windows and Drivers CDROMs
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#startvm">
                            <strong>Step 2.4 -</strong> Start VM
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#kswpwinrmhttpswait">
                            <strong>Step 2.5 -</strong> KSWP WinRM HTTPS Wait
                        </a>
                    </p>


        

                    <p class="text-muted pt-2">
                        <a href="#installparallelstools">
                            <strong>Step 3 -</strong> Install Parallels Tools
                        </a>
                    </p>
    
        

                    <p class="text-muted pt-2">
                        <a href="#deployparallelstools">
                            <strong>Step 3.1 -</strong> Deploy Parallels Tools
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#mountparallelstoolsiso">
                            <strong>Step 3.2 -</strong> Mount Parallels Tools ISO
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#runptagentexe">
                            <strong>Step 3.3 -</strong> Run PTAgent.exe
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#unmountparallelstoolsiso">
                            <strong>Step 3.4 -</strong> Unmount Parallels Tools ISO
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#removeisofromsoftware">
                            <strong>Step 3.5 -</strong> Remove ISO from Software
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#kswpshutdownvm">
                            <strong>Step 3.6 -</strong> KSWP Shutdown VM
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#startvm">
                            <strong>Step 3.7 -</strong> Start VM
                        </a>
                    </p>

        

                    <p class="text-muted pt-2">
                        <a href="#kswpwinrmhttpswait">
                            <strong>Step 3.8 -</strong> KSWP WinRM HTTPS Wait
                        </a>
                    </p>



                </div>
            </div>

<!-- Blueprint Contents -->
            <div class="col-lg-8 pt-3">
                <div class="container">


        <div class="jumbotron">
            <p class="display-3 text-center">
                <strong>Automate This</strong>
            </p>
            <p class="lead text-center">
                Use the <strong>Attune GUI</strong> for your Scripts
            </p>
            <p class="lead">
                <ol>
                    <a href="https://www.servertribe.com/download-attune-registration/"
                        target="_blank">
                        <span class="badge badge-primary">1</span>
                        Download Attune
                        <i class="fa-solid fa-download fa-beat-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://github.com/attune-Automation/"
                        target="_blank">
                        <span class="badge badge-primary">2</span>
                         Copy the Attune Project URL
                         <i class="fa-brands fa-github fa-fade"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://servertribe-attune.readthedocs.io/en/latest/howto/design_workspace/clone_project.html"
                        target="_blank">
                        <span class="badge badge-primary">3</span>
                        Clone the Project in Attune
                         <i class="fa-solid fa-book fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=GCWDI29rDV0"
                        target="_blank">
                        <span class="badge badge-primary">4</span>
                        Plan your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
                <ol>
                    <a href="https://www.youtube.com/watch?v=b7DhFcURkZg"
                        target="_blank">
                        <span class="badge badge-primary">5</span>
                        Run your Job(s)
                        <i class="fa-brands fa-youtube fa-fade" style="color: #0197ff;"></i>
                    </a>
                </ol>
            </p>
            <p class="lead text-center">
                You've automated: <strong>Parallels Recreate Windows Virtual Machine and Install Tools</strong>
            </p>
            <hr class="my-4 text-center">
            <div class="col px-0">
                <p class="text-center">
                    Get the most out of automation with our get started
                    videos, product demonstrations, and more.
                </p>
                <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://www.servertribe.com/learn/"
                       target="_blank"
                       role="button">
                        Learn Attune Automation
                    </a>
                </p>
            </div>
        </div>

        <div class="row">
            <p>The following steps will guide you through the manual process.</p>
        </div>

<!-- Blueprint Steps -->


        



                    <div class="row pt-5">
                        <h3 id="recreatewindowsvirtualmachineonmacosparallels">
                            <a href="#recreatewindowsvirtualmachineonmacosparallels">
                                <strong>Step 1 -</strong> Recreate Windows Virtual Machine on macOS Parallels
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Recreates a Parallels Desktop virtual machine using:</p>
<ol>
<li>1 x unaltered Windows ISO.</li>
<li>1 x drivers ISO.</li>
</ol>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="deletevm">
                            <a href="#deletevm">
                                <strong>Step 1.1 -</strong> Delete VM
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deletes the Virtual Machine.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {macoshostuser}@{macoshost}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;

if prlctl list &quot;${VM}&quot;
then
    echo &quot;VM Found&quot;
    
    echo  &quot;Deleting VM : ${VM}&quot;
    if prlctl delete &quot;${VM}&quot;
    then  
        echo &quot;Success&quot;
    else 
        prlctl stop &quot;${VM}&quot; --kill
        prlctl delete &quot;${VM}&quot;
    fi
else
    echo &quot;No VM, continuing.&quot;
fi
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="createvm">
                            <a href="#createvm">
                                <strong>Step 1.2 -</strong> Create VM
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Creates the virtual machine.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;
set -x

# Create the VM
prlctl create &quot;${VM}&quot; --ostype {ksParallelsOstype}

# Set the VM Paramaters
prlctl set &quot;${VM}&quot; --memsize $(({ksVmRamSizeGb}*1024))

# Set the VM CPU Count
prlctl set &quot;${VM}&quot; --cpus {ksVmCpuCount}

# All Synerty kickstarts are 50gb as a standard
prlctl set &quot;${VM}&quot; --size 51200

# Disable EFI boot
#prlctl set &quot;${VM}&quot; --efi-boot=off
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="loadwindowsiso">
                            <a href="#loadwindowsiso">
                                <strong>Step 1.3 -</strong> Load Windows ISO
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Loads the Windows ISO to the first CD ROM.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;

DIR=&quot;${HOME}/Parallels/os_auto_install/&quot;

# Set up the Virtual Machine by mounting the .iso to a cd drive
prlctl set &quot;${VM}&quot; \
    --device-set cdrom0 \
    --image ${DIR}/kickstart_{targetServer.fqn}.iso \
    --enable \
    --connect
    
# this should be a D: drive
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="startvm">
                            <a href="#startvm">
                                <strong>Step 1.4 -</strong> Start VM
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Starts the virtual machine.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;

echo &quot;Starting ${VM}&quot;
prlctl start &quot;${VM}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="winrmhttpswait120sdelay">
                            <a href="#winrmhttpswait120sdelay">
                                <strong>Step 1.5 -</strong> WinRM HTTPS Wait 120s Delay
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>A longer post wait time here is required here because WinRM HTTPS will be active before Windows has finished "Setting up everything for you".</p>
                            </p>
                        </div>
                    </div>












    

    <div class="row">
        <p class="mb-0">
            Check if TCP Port <strong>0</strong> is listening.
            When the TCP Port is up, wait <strong>120</strong>
            seconds.
        </p>
        <p>Use Telnet to check if the TCP Service is accepting connections.</p>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="removecdromdrivesandrestart">
                            <a href="#removecdromdrivesandrestart">
                                <strong>Step 2 -</strong> Remove CD ROM Drives and Restart
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Removes both CD ROMs.</p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="winrmhttpswait120sdelay">
                            <a href="#winrmhttpswait120sdelay">
                                <strong>Step 2.1 -</strong> WinRM HTTPS Wait 120s Delay
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>A longer post wait time here is required here because WinRM HTTPS will be active before Windows has finished "Setting up everything for you".</p>
                            </p>
                        </div>
                    </div>









    

    

    <div class="row">
        <p class="mb-0">
            Check if TCP Port <strong>0</strong> is listening.
            When the TCP Port is up, wait <strong>120</strong>
            seconds.
        </p>
        <p>Use Telnet to check if the TCP Service is accepting connections.</p>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="kswpshutdownvm">
                            <a href="#kswpshutdownvm">
                                <strong>Step 2.2 -</strong> KSWP Shutdown VM
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Shut down virtual machine.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {macoshostuser}@{macoshost}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;

echo &quot;Shutting down ${VM}&quot;
prlctl stop &quot;${VM}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="kswpremovewindowsanddriverscdroms">
                            <a href="#kswpremovewindowsanddriverscdroms">
                                <strong>Step 2.3 -</strong> KSWP Remove Windows and Drivers CDROMs
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Remove Windows and drivers CDROMs.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;
set -x


# Remove Windows CDROM
prlctl set &quot;${VM}&quot; --device-del cdrom0
#prlctl set &quot;${VM}&quot; --device-set cdrom0 --disconnect

# Remove Drivers CDROM
prlctl set &quot;${VM}&quot; --device-del cdrom1
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="startvm">
                            <a href="#startvm">
                                <strong>Step 2.4 -</strong> Start VM
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Starts the virtual machine.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;

echo &quot;Starting ${VM}&quot;
prlctl start &quot;${VM}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="kswpwinrmhttpswait">
                            <a href="#kswpwinrmhttpswait">
                                <strong>Step 2.5 -</strong> KSWP WinRM HTTPS Wait
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>












    

    <div class="row">
        <p class="mb-0">
            Check if TCP Port <strong>0</strong> is listening.
            When the TCP Port is up, wait <strong>10</strong>
            seconds.
        </p>
        <p>Use Telnet to check if the TCP Service is accepting connections.</p>
    </div>






        



                    <div class="row pt-5">
                        <h3 id="installparallelstools">
                            <a href="#installparallelstools">
                                <strong>Step 3 -</strong> Install Parallels Tools
                            </a>
                        </h3>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Install Parallels Tools. Use this after Windows installation has completed.</p>
                            </p>
                        </div>
                    </div>





    




    



                    <div class="row pt-5">
                        <h4 id="deployparallelstools">
                            <a href="#deployparallelstools">
                                <strong>Step 3.1 -</strong> Deploy Parallels Tools
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deploys Windows Parallels Tools ISO to <code>/c$/software</code>.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via RDP:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
mstsc /admin /v:{kickstartedwindowsnode}
                            </code>
                        </div>
                        <div class="row">
                            <p>
                                Login as user {windowsadministrator} and open a
                                command prompt.
                            </p>
                        </div>


    



    <div class="row">
        <p>
            <p>Get from "/Applications/Parallels Desktop.app/Contents/Resources/Tools/prl-tools-win.iso".</p>
        </p>
        <p>
            Copy the File(s)
            <strong>Parallels_Tools.tar</strong>
            to the target node.
        </p>
        <p>
            <strong>Deploy the File(s)</strong> here:
        </p>
    </div>
    <div class="row py-1">
        <code class="language-bash">
/c$/software
        </code>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="mountparallelstoolsiso">
                            <a href="#mountparallelstoolsiso">
                                <strong>Step 3.2 -</strong> Mount Parallels Tools ISO
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Mounts Windows Parallels Tools ISO to <code>D:</code> drive.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$FOLDER = &quot;C:\software&quot;
Set-Location -Path &quot;${FOLDER}&quot;

$ISO_NAME = (Get-ChildItem *.iso).Name

Write-Host &quot;ISO_NAME = ${ISO_NAME}&quot;

Mount-DiskImage -ImagePath &quot;${FOLDER}\${ISO_NAME}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="runptagentexe">
                            <a href="#runptagentexe">
                                <strong>Step 3.3 -</strong> Run PTAgent.exe
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Runs a silent installation of PTAgent.exe. More inforamation is at
https://kb.parallels.com/en/116161.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
D:\PTagent.exe /install_silent
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="unmountparallelstoolsiso">
                            <a href="#unmountparallelstoolsiso">
                                <strong>Step 3.4 -</strong> Unmount Parallels Tools ISO
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Unmounts the <code>D:</code> drive.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$FOLDER = &quot;C:\software&quot;
Set-Location -Path &quot;${FOLDER}&quot;

$ISO_NAME = (Get-ChildItem *.iso).Name

Write-Host &quot;ISO_NAME = ${ISO_NAME}&quot;

Dismount-DiskImage -ImagePath &quot;${FOLDER}\${ISO_NAME}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="removeisofromsoftware">
                            <a href="#removeisofromsoftware">
                                <strong>Step 3.5 -</strong> Remove ISO from Software
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Deletes the Parallels Tools ISO from <code>C:\software</code>.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
$FOLDER = &quot;C:\software&quot;
Set-Location -Path &quot;${FOLDER}&quot;

$ISO_NAME = (Get-ChildItem *.iso).Name

Remove-Item $ISO_NAME
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="kswpshutdownvm">
                            <a href="#kswpshutdownvm">
                                <strong>Step 3.6 -</strong> KSWP Shutdown VM
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Shut down virtual machine.</p>
                            </p>
                        </div>
                    </div>










                        <div class="row">
                            <p>
                                Connect via ssh:
                            </p>
                        </div>
                        <div class="row py-1">
                            <code class="language-sql">
ssh {macoshostuser}@{macoshost}
                            </code>
                        </div>



    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;

echo &quot;Shutting down ${VM}&quot;
prlctl stop &quot;${VM}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="startvm">
                            <a href="#startvm">
                                <strong>Step 3.7 -</strong> Start VM
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                <p>Starts the virtual machine.</p>
                            </p>
                        </div>
                    </div>









    


    



    <div class="row">
        <p>
            Execute the following script:
        </p>
    </div>
    <div class="row">
        <div class="col px-0">
            <pre>
                <code class="language-sql py-0">
VM=&#x27;{kickstartedNode.hostname}&#x27;

echo &quot;Starting ${VM}&quot;
prlctl start &quot;${VM}&quot;
                </code>
            </pre>
        </div>
    </div>





    



                    <div class="row pt-5">
                        <h4 id="kswpwinrmhttpswait">
                            <a href="#kswpwinrmhttpswait">
                                <strong>Step 3.8 -</strong> KSWP WinRM HTTPS Wait
                            </a>
                        </h4>
                    </div>

                    <div class="row">
                        <div class="description col px-0">
                            <p>
                                
                            </p>
                        </div>
                    </div>












    

    <div class="row">
        <p class="mb-0">
            Check if TCP Port <strong>0</strong> is listening.
            When the TCP Port is up, wait <strong>10</strong>
            seconds.
        </p>
        <p>Use Telnet to check if the TCP Service is accepting connections.</p>
    </div>







                    <div class="row pt-5">
                        <div class="col">
                            <h2>Completed</h2>
                            <p>
                                You have completed this instruction.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

<!-- Download Attune Ad -->

            <div class="toc col-lg-2 px-0">
                <div class="container px-0 pt-3 pl-5">
                    <div class="card border-light mb-3" style="max-width: 18rem;">
                        <div class="card-body attune-ad">
                            <img
                                src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                                alt="Attune - Powered by ServerTribe"
                                class="img-fluid">
                            <p class="card-title mt-3 text-center">
                                <strong>Automate with Attune</strong>
                            </p>
                            <p class="card-text text-center">
                                Download the Attune Community Edition.
                            </p>
                            <p class="text-center">
                                <a href="https://www.servertribe.com/download-attune-registration/"
                                   class="btn btn-primary mt-3">
                                    DOWNLOAD!!!
                                </a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>

        </div>

<!-- Join Discord -->

        <div class="row py-5">
            <div class="jumbotron">
              <h1 class="display-4 text-center">
                  Discuss this Project in Discord
              </h1>
              <p class="lead">

                  Join our Discord channel and connect with like-minded individuals who
                  share your passion. Engage in lively discussions, gain valuable insights,
                  and stay updated on the latest trends in our industry. Don't miss out on
                  this opportunity to network, learn, and grow together.
              </p>
              <hr class="my-4 text-center">
                <div class="col px-0">
                  <p class="text-center">
                      Click the link below and become a part of our vibrant community on
                      Discord today!
                  </p>
                  <p class="lead text-center">
                    <a class="btn btn-primary btn-lg"
                       href="https://discord.com/invite/3YpJsagqUn"
                       role="button">
                        Join NOW!!!
                    </a>
                  </p>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- Project Footer -->

<footer class="footer fixed-bottom bg-white border-top box-shadow">
      <div class="container px-0">
          <div class="row">
              <div class="col px-0">
                  <a class="my-0 mr-lg-auto"
                     href="https://www.servertribe.com/"
                     target="_blank">
                      <img
                          src="https://www.servertribe.com/wp-content/uploads/2022/06/AttuneLogoV2_powered_by.png"
                          alt="Attune - Powered by ServerTribe"
                          class="img-fluid navbar-img">
                  </a>
              </div>
          </div>
      </div>
</footer>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
<script
    src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>


</body>
</html>
